<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Quiz Controller</title>
<style>
body{font-family:Arial;text-align:center;background:#f4f4f4;padding:20px}
button{width:100%;padding:14px;margin:8px 0;border:none;border-radius:8px;background:#243b55;color:white;font-size:18px}
</style>
</head>
<body>

<h2 id="question"></h2>
<div id="answers"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue, update }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig={
apiKey:"AIzaSyCODp3h025sM3jl7Ji0GJgVuGoWCD1wddU",
authDomain:"syncplay-17b6e.firebaseapp.com",
databaseURL:"https://syncplay-17b6e-default-rtdb.firebaseio.com",
projectId:"syncplay-17b6e"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

const code=localStorage.getItem("party");
const uid=localStorage.getItem("uid");

const questions=[
{q:"Capital of Italy?",a:["Rome","Paris","Berlin","Madrid"],c:0},
{q:"3+5?",a:["6","7","8","9"],c:2}
];

onValue(ref(db,"parties/"+code),snap=>{
const data=snap.val();
if(!data||data.gameState!=="question") return;

const q=questions[data.currentQuestion];
document.getElementById("question").textContent=q.q;

const div=document.getElementById("answers");
div.innerHTML="";
q.a.forEach((ans,i)=>{
const btn=document.createElement("button");
btn.textContent=ans;
btn.onclick=()=>submit(i,data);
div.appendChild(btn);
});
});

function submit(choice,data){
if(data.answered) return;

if(choice===questions[data.currentQuestion].c){
update(ref(db,"parties/"+code+"/players/"+uid),{
score:(data.players[uid].score||0)+1
});
}
update(ref(db,"parties/"+code),{answered:true});
}
</script>
</body>
</html>
