<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SyncPlay Controller</title>
<style>
  body { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; font-family:sans-serif; background:#222; color:white; }
  button { font-size:24px; padding:20px 40px; margin:10px; }
</style>
</head>
<body>
<h2 id="title">Controller</h2>
<div id="buttons"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="firebase.js"></script>

<script>
// Get game from URL
const urlParams = new URLSearchParams(window.location.search);
const game = urlParams.get('game') || 'pong';
document.getElementById('title').innerText = `Controller - ${game.charAt(0).toUpperCase() + game.slice(1)}`;

// Assign unique player ID
const playerId = 'player_' + Date.now();

// Reference node based on game
const gameRef = db.ref(`${game}Inputs`);
gameRef.child(playerId).set({y:160});
gameRef.child(playerId).onDisconnect().remove();

const buttonsDiv = document.getElementById('buttons');

if(game === 'pong'){
  // Pong buttons
  const up = document.createElement('button');
  up.innerText = 'Up';
  up.onclick = ()=>move(-10);
  const down = document.createElement('button');
  down.innerText = 'Down';
  down.onclick = ()=>move(10);
  buttonsDiv.appendChild(up);
  buttonsDiv.appendChild(down);

  function move(dy){
    gameRef.child(playerId).once('value').then(s=>{
      const pos = s.val().y + dy;
      const newY = Math.min(Math.max(pos,0),320);
      gameRef.child(playerId).update({y:newY});
    });
  }
}

// You can add more games like Trivia here
</script>
</body>
</html>
