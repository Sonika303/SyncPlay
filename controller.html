<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Controller</title>
<style>
body{
  font-family:Arial;
  background:#fff;
  text-align:center;
  padding-top:30px;
}
button{
  font-size:22px;
  padding:20px;
  margin:10px;
}
</style>
</head>
<body>

<h3 id="status">Connecting…</h3>

<div>
  <button onclick="move(0,-15)">⬆️</button><br>
  <button onclick="move(-15,0)">⬅️</button>
  <button onclick="move(15,0)">➡️</button><br>
  <button onclick="move(0,15)">⬇️</button>
</div>

<br>
<button onclick="location.href='index.html'">Exit</button>

<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
<script>
const u=sessionStorage.getItem("u");
const c=sessionStorage.getItem("c");
if(!u||!c) location.href="index.html";

const peer=new Peer();
let conn,myId;

peer.on("open",id=>{
  myId=id;
  conn=peer.connect(c);
  conn.on("open",()=>status.textContent="Connected");
  conn.on("data",d=>{
    if(d.type==="state"){
      status.textContent=d.it===myId?"YOU ARE IT":"CHASE / RUN";
    }
  });
});

function move(dx,dy){
  if(conn) conn.send({type:"move",dx,dy});
}
</script>

</body>
</html>
