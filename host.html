<body>

<div id="top">
  <div>Code: <b id="code"></b></div>
  <button onclick="exit()">Exit</button>
</div>

<!-- LOBBY -->
<div id="lobby">
  <h2>Select Game</h2>

  <div id="carousel">
    <button onclick="move(-1)">◀</button>
    <div id="card"></div>
    <button onclick="move(1)">▶</button>
  </div>

  <button onclick="startGame()">Start Game</button>
</div>

<!-- GAME -->
<canvas id="c" width="800" height="400" style="display:none"></canvas>

<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
<script>
const partyCode = (Math.floor(10000 + Math.random()*90000))+"";
code.textContent = partyCode;

const games = [
  { name:"Stickman Tag", id:"tag" },
  { name:"Dot Chase", id:"dot" }
];

let selectedGame = 0;
let phase = "lobby";

const peer = new Peer(partyCode);
const players = [];

peer.on("connection",conn=>{
  players.push(conn);
  syncLobby();
});

function move(dir){
  selectedGame = (selectedGame + dir + games.length) % games.length;
  syncLobby();
}

function syncLobby(){
  card.textContent = games[selectedGame].name;
  players.forEach(p=>{
    p.send({
      type:"lobby",
      selectedGame,
      phase
    });
  });
}

function startGame(){
  phase = "game";
  lobby.style.display="none";
  c.style.display="block";
  players.forEach(p=>{
    p.send({type:"start",game:games[selectedGame].id});
  });
  // game logic continues later
}

function exit(){
  sessionStorage.clear();
  location.href="index.html";
}

syncLobby();
</script>

<style>
#top{
  display:flex;
  justify-content:space-between;
  padding:10px;
  border-bottom:1px solid #ccc;
}
#lobby{
  text-align:center;
  margin-top:40px;
}
#carousel{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:20px;
  margin:20px;
}
#card{
  width:200px;
  height:120px;
  border:1px solid #000;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
}
button{
  padding:10px 16px;
}
</style>

</body>
