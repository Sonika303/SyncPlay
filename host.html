<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trivia Host</title>
<style>
body{margin:0;font-family:Arial;background:linear-gradient(135deg,#141e30,#243b55);color:white;padding:20px}
.panel{background:white;color:#222;padding:15px;border-radius:12px;margin-bottom:15px}
button{padding:10px 15px;border:none;border-radius:6px;background:#243b55;color:white;cursor:pointer}
button:hover{background:#141e30}
</style>
</head>
<body>

<h2>Trivia Host</h2>
Party Code: <b id="code"></b>
<button onclick="exit()">Exit</button>

<div class="panel">
<h3>Players</h3>
<div id="players"></div>
</div>

<div class="panel" id="questionBox" style="display:none">
<h3 id="question"></h3>
<div id="answers"></div>
</div>

<button id="startBtn">Start Game</button>
<button id="nextBtn" style="display:none">Next Question</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

const app=initializeApp({
apiKey:"YOUR_API_KEY",
authDomain:"syncplay-17b6e.firebaseapp.com",
databaseURL:"https://syncplay-17b6e-default-rtdb.firebaseio.com",
projectId:"syncplay-17b6e"
});
const db=getDatabase(app);

const code=sessionStorage.getItem("c");
document.getElementById("code").textContent=code;

const questions=[
{q:"Capital of Japan?",a:["Seoul","Tokyo","Bangkok","Beijing"],c:1},
{q:"2+8?",a:["8","9","10","11"],c:2},
{q:"Fastest land animal?",a:["Tiger","Cheetah","Lion","Horse"],c:1}
];

let current=0;

onValue(ref(db,"parties/"+code+"/players"),snap=>{
  const players=snap.val()||{};
  const div=document.getElementById("players");
  div.innerHTML="";
  Object.values(players).forEach(p=>{
    div.innerHTML+=`<div>${p.username} - ${p.score}</div>`;
  });
});

document.getElementById("startBtn").onclick=()=>{
  document.getElementById("startBtn").style.display="none";
  document.getElementById("nextBtn").style.display="inline-block";
  showQuestion();
};

document.getElementById("nextBtn").onclick=()=>{
  current++;
  if(current>=questions.length){alert("Game Finished");return;}
  showQuestion();
};

function showQuestion(){
  const q=questions[current];
  document.getElementById("questionBox").style.display="block";
  document.getElementById("question").textContent=q.q;

  update(ref(db,"parties/"+code),{
    gameState:"question",
    currentQuestion:current,
    correct:q.c,
    answered:false
  });
}

window.exit=()=>{
sessionStorage.clear();
location.href="index.html";
};
</script>
</body>
</html>
